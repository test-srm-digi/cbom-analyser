// @use 'sass:color';
@use '../../../styles/variables' as *;

/* ═══════════════════════════════════════════════════════════════
   Discovery — Shared Component Styles
   ═══════════════════════════════════════════════════════════════ */

/* ── Stat cards ───────────────────────────────────────────── */
.stats {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 16px;
  margin-bottom: 20px;
}

.statCard {
  background: $dc1-card;
  border-radius: $dc1-radius;
  border: 1px solid $dc1-border;
  padding: 20px 24px;
  border-left: 4px solid $dc1-blue;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.statCardSuccess { @extend .statCard; border-left-color: $dc1-success; }
.statCardDanger  { @extend .statCard; border-left-color: $dc1-danger; }

.statHeader {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.statTitle {
  font-size: 14px;
  font-weight: 600;
  color: $dc1-text;
}

.statIcon {
  width: 18px;
  height: 18px;
  color: $dc1-text-muted;
}

.statIconSuccess { @extend .statIcon; color: $dc1-success; }
.statIconDanger  { @extend .statIcon; color: $dc1-danger; }

.statValue {
  font-size: 28px;
  font-weight: 700;
  color: $dc1-blue;
  line-height: 1.2;
}

.statValueSuccess { @extend .statValue; color: $dc1-success; }
.statValueDanger  { @extend .statValue; color: $dc1-danger; }

.statSub {
  font-size: 12px;
  color: $dc1-text-muted;
}

/* ── AI recommendation banner ─────────────────────────────── */
.aiBanner {
  display: flex;
  align-items: center;
  gap: 12px;
  background: linear-gradient(90deg, #FFFBEB 0%, #FEF3C7 100%);
  border: 1px solid #F5D98C;
  border-radius: $dc1-radius;
  padding: 14px 20px;
  margin-bottom: 20px;
}

.aiBannerIcon {
  width: 22px;
  height: 22px;
  color: #D97706;
  flex-shrink: 0;
}

.aiBannerText {
  flex: 1;
  font-size: 13px;
  color: $dc1-text;
  line-height: 1.5;

  strong { font-weight: 700; }
}

.aiBannerBtn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 8px 20px;
  border-radius: 9999px;
  border: none;
  background: linear-gradient(135deg, #9333EA, #7C3AED, #6D28D9);
  color: #fff;
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  white-space: nowrap;
  letter-spacing: 0.01em;
  box-shadow: 0 2px 8px rgba(#9333EA, 0.3), inset 0 1px 0 rgba(#fff, 0.15);
  transition: transform 0.15s ease, box-shadow 0.15s ease, opacity 0.15s ease;

  &:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 14px rgba(#9333EA, 0.4), inset 0 1px 0 rgba(#fff, 0.15);
  }

  &:active {
    transform: translateY(0);
    box-shadow: 0 1px 4px rgba(#9333EA, 0.25);
  }

  &:disabled {
    opacity: 0.7;
    cursor: not-allowed;
    transform: none;
  }
}

.aiBannerBtnIcon {
  width: 14px;
  height: 14px;
}

/* ── Toolbar ──────────────────────────────────────────────── */
.toolbar {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 16px;
}

.searchBar {
  flex: 1;
  display: flex;
  align-items: center;
  gap: 8px;
  border: 1px solid $dc1-border;
  border-radius: $dc1-radius-sm;
  padding: 8px 14px;
  background: $dc1-card;
}

.searchIcon {
  width: 16px;
  height: 16px;
  color: $dc1-text-muted;
  flex-shrink: 0;
}

.searchInput {
  border: none;
  outline: none;
  background: transparent;
  font-size: 13px;
  color: $dc1-text;
  flex: 1;
  font-family: $dc1-font;

  &::placeholder { color: $dc1-text-muted; }
}

.exportBtn {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 16px;
  border: 1px solid $dc1-border;
  border-radius: $dc1-radius-sm;
  background: $dc1-card;
  color: $dc1-text;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: background $transition-fast;

  &:hover { background: $neutral-50; }
}

.exportIcon {
  width: 14px;
  height: 14px;
}

.filterToggle {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 36px;
  height: 36px;
  border: 1px solid $dc1-border;
  border-radius: $dc1-radius-sm;
  background: $dc1-card;
  color: $dc1-text-secondary;
  cursor: pointer;
  transition: background $transition-fast;

  &:hover { background: $neutral-50; }
}

.filterIcon {
  width: 16px;
  height: 16px;
}

/* ── Reset / Clear data button ────────────────────────────── */
.resetBtn {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 16px;
  border: 1px solid $dc1-danger;
  border-radius: $dc1-radius-sm;
  background: $dc1-card;
  color: $dc1-danger;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: background $transition-fast, color $transition-fast;
  white-space: nowrap;

  &:hover {
    background: $dc1-danger;
    color: #fff;

    .resetIcon { color: #fff; }
  }

  &:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    &:hover { background: $dc1-card; color: $dc1-danger; }
  }
}

.resetIcon {
  width: 14px;
  height: 14px;
  color: $dc1-danger;
}

@keyframes spin {
  from { transform: rotate(0deg); }
  to   { transform: rotate(-360deg); }
}

.spinning {
  animation: spin 1s linear infinite;
}

/* ── Sub-tab switcher ─────────────────────────────────────── */
.subTabBar {
  display: flex;
  gap: 0;
  border-bottom: 2px solid $dc1-border;
  margin-bottom: 0;
}

.subTabBtn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 10px 20px;
  font-size: 13px;
  font-weight: 500;
  color: $dc1-text-secondary;
  background: none;
  border: none;
  border-bottom: 2px solid transparent;
  margin-bottom: -2px;
  cursor: pointer;
  transition: color $transition-fast, border-color $transition-fast;

  &:hover {
    color: $dc1-text;
  }
}

.subTabBtnActive {
  color: #7C3AED;
  border-bottom-color: #7C3AED;
  font-weight: 600;
}

.subTabIcon {
  width: 14px;
  height: 14px;
}

.subTabCount {
  font-size: 11px;
  font-weight: 600;
  background: $neutral-50;
  color: $dc1-text-secondary;
  padding: 1px 7px;
  border-radius: 10px;
  min-width: 20px;
  text-align: center;

  .subTabBtnActive & {
    background: rgba(#7C3AED, 0.1);
    color: #7C3AED;
  }
}

/* ── Table card ───────────────────────────────────────────── */
.tableCard {
  background: $dc1-card;
  border: 1px solid $dc1-border;
  border-radius: $dc1-radius;
  padding: 20px 24px;
  overflow-x: auto;
}

.tableTitle {
  font-size: 16px;
  font-weight: 600;
  color: $dc1-text;
  margin: 0 0 16px;
}

.table {
  width: 100%;
  border-collapse: collapse;
  font-size: 13px;
}

.table thead th {
  text-align: left;
  padding: 10px 12px;
  font-size: 12px;
  font-weight: 600;
  color: $dc1-text-secondary;
  border-bottom: 1px solid $dc1-border;
  white-space: nowrap;
}

.sortIcon {
  width: 12px;
  height: 12px;
  vertical-align: middle;
  margin-left: 4px;
  color: $dc1-text-muted;
}

.table tbody tr {
  border-bottom: 1px solid rgba($dc1-border, 0.5);
  transition: background $transition-fast;

  &:hover { background: rgba($dc1-bg, 0.5); }
}

.table tbody td {
  padding: 12px 12px;
  color: $dc1-text;
  vertical-align: middle;
}

/* ── Badges ───────────────────────────────────────────────── */
.badgeIssued {
  display: inline-block;
  padding: 3px 10px;
  border-radius: 4px;
  font-size: 12px;
  font-weight: 600;
  background: $dc1-success;
  color: $dc1-card;
}

.badgeExpired  { @extend .badgeIssued; background: $dc1-danger; }
.badgeRevoked  { @extend .badgeIssued; background: $neutral-600; }
.badgePending  { @extend .badgeIssued; background: $dc1-warning; color: $dc1-text; }

.badgeEnrolled   { @extend .badgeIssued; background: $dc1-success; }
.badgeDevPending { @extend .badgeIssued; background: $dc1-warning; color: $dc1-text; }
.badgeDevExpired { @extend .badgeIssued; background: $dc1-danger; }
.badgeDevRevoked { @extend .badgeIssued; background: $neutral-600; }

.badgeProcessed  { @extend .badgeIssued; background: $dc1-success; }
.badgeProcessing { @extend .badgeIssued; background: $dc1-blue; }
.badgeFailed     { @extend .badgeIssued; background: $dc1-danger; }
.badgePartial    { @extend .badgeIssued; background: $dc1-warning; color: $dc1-text; }

.qsYes {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 3px 10px;
  border-radius: 4px;
  font-size: 12px;
  font-weight: 600;
  background: $dc1-success-bg;
  color: $dc1-success;
  border: 1px solid rgba($dc1-success, 0.3);
}

.qsNo {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 3px 10px;
  border-radius: 4px;
  font-size: 12px;
  font-weight: 600;
  background: $dc1-danger-bg;
  color: $dc1-danger;
  border: 1px solid rgba($dc1-danger, 0.3);
}

.qsDot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: currentColor;
}

/* ── Severity badges ──────────────────────────────────────── */
.severityCritical {
  display: inline-block;
  padding: 3px 10px;
  border-radius: 4px;
  font-size: 12px;
  font-weight: 600;
  background: $dc1-danger;
  color: $dc1-card;
}

.severityHigh {
  @extend .severityCritical;
  background: $error-50;
  color: $dc1-danger;
  border: 1px solid rgba($dc1-danger, 0.3);
}

.severityMedium {
  @extend .severityCritical;
  background: $warning-50;
  color: $warning-200;
  border: 1px solid rgba($dc1-warning, 0.3);
}

.severityLow {
  @extend .severityCritical;
  background: $blue-50;
  color: $dc1-blue;
  border: 1px solid rgba($dc1-blue, 0.2);
}

.severityInfo {
  @extend .severityCritical;
  background: $neutral-100;
  color: $dc1-text-secondary;
  border: 1px solid $dc1-border;
}

/* ── Source & action links ────────────────────────────────── */
.sourceLink {
  color: $dc1-blue;
  font-size: 12px;
  font-weight: 500;
  text-decoration: none;

  &:hover { text-decoration: underline; }
}

.actions {
  display: flex;
  align-items: center;
  gap: 8px;
  justify-content: flex-end;
}

.upgradeBtn {
  display: inline-flex;
  align-items: center;
  gap: 5px;
  padding: 5px 14px;
  border: none;
  border-radius: 4px;
  background: linear-gradient(135deg, #7C3AED 0%, #6D28D9 100%);
  color: $dc1-card;
  font-size: 11px;
  font-weight: 600;
  cursor: pointer;
  white-space: nowrap;
  transition: opacity $transition-fast;

  &:hover { opacity: 0.9; }
}

.upgradeIcon {
  width: 12px;
  height: 12px;
}

.actionBtn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 28px;
  height: 28px;
  border-radius: $dc1-radius-sm;
  border: 1px solid $dc1-border;
  background: $dc1-card;
  color: $dc1-text-secondary;
  cursor: pointer;
  transition: background $transition-fast, color $transition-fast;

  &:hover {
    background: $neutral-50;
    color: $dc1-text;
  }
}

.actionIcon {
  width: 14px;
  height: 14px;
}

/* ── TLS version pill ─────────────────────────────────────── */
.tlsPill {
  display: inline-block;
  padding: 2px 10px;
  border-radius: 4px;
  font-size: 12px;
  font-weight: 500;
  background: $neutral-100;
  color: $dc1-text;
  border: 1px solid $dc1-border;
}

/* ── Chip tags ────────────────────────────────────────────── */
.libChips {
  display: flex;
  flex-wrap: wrap;
  gap: 4px;
}

.libChip {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 3px;
  font-size: 11px;
  font-family: monospace;
  background: $dc1-blue-light;
  color: $dc1-blue-dark;
  border: 1px solid rgba($dc1-blue, 0.15);
}

/* ── Mono text ────────────────────────────────────────────── */
.mono {
  font-family: monospace;
  font-size: 12px;
}

/* ── Progress bar (for CBOM imports) ──────────────────────── */
.progressBar {
  display: flex;
  align-items: center;
  gap: 8px;
}

.progressTrack {
  flex: 1;
  height: 6px;
  background: $neutral-100;
  border-radius: 3px;
  overflow: hidden;
}

.progressFill {
  height: 100%;
  border-radius: 3px;
  background: $dc1-success;
  transition: width 0.3s ease;
}

.progressLabel {
  font-size: 12px;
  font-weight: 600;
  color: $dc1-text-secondary;
  min-width: 36px;
  text-align: right;
}

/* ═══════════════════════════════════════════════════════════════
   Empty State — No data / integration not connected
   ═══════════════════════════════════════════════════════════════ */

.emptyState {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

/* ── Hero ─────────────────────────────────────────────────── */
.emptyHero {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  background: $dc1-card;
  border: 1px solid $dc1-border;
  border-radius: $dc1-radius;
  padding: 48px 40px 40px;
}

.emptyIconWrap {
  width: 64px;
  height: 64px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  background: $blue-50;
  margin-bottom: 20px;
}

.emptyIcon {
  width: 28px;
  height: 28px;
  color: $dc1-blue;
}

.emptyTitle {
  font-size: 20px;
  font-weight: 700;
  color: $dc1-text;
  margin: 0 0 8px;
}

.emptyDesc {
  font-size: 14px;
  color: $dc1-text-secondary;
  margin: 0 0 4px;
  max-width: 560px;
  line-height: 1.5;

  strong { font-weight: 600; color: $dc1-text; }
}

.emptyDescSub {
  font-size: 13px;
  color: $dc1-text-muted;
  margin: 0;
  max-width: 560px;
  line-height: 1.5;
}

/* ── Go to Integrations button ────────────────────────────── */
.goToIntegrationsBtn {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  margin-top: 18px;
  padding: 10px 24px;
  border-radius: $dc1-radius-sm;
  border: none;
  background: $dc1-blue;
  color: #fff;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: background $transition-fast, box-shadow $transition-fast;

  &:hover {
    // background: color.adjust($dc1-blue, $lightness: -8%);
    box-shadow: 0 2px 8px rgba($dc1-blue, 0.25);
  }

  &:active {
    transform: scale(0.98);
  }
}

/* ── Steps card ───────────────────────────────────────────── */
.stepsCard {
  background: $dc1-card;
  border: 1px solid $dc1-border;
  border-radius: $dc1-radius;
  overflow: hidden;
}

.stepsHeader {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 18px 24px;
  border-bottom: 1px solid $dc1-border;
  background: $neutral-50;
}

.stepsHeaderIcon {
  width: 18px;
  height: 18px;
  color: $dc1-blue;
}

.stepsTitle {
  font-size: 15px;
  font-weight: 600;
  color: $dc1-text;
  margin: 0;
}

.stepsList {
  list-style: none;
  padding: 0;
  margin: 0;
}

.stepItem {
  display: flex;
  align-items: flex-start;
  gap: 14px;
  padding: 18px 24px;
  border-bottom: 1px solid rgba($dc1-border, 0.5);

  &:last-child { border-bottom: none; }
}

.stepNumber {
  flex-shrink: 0;
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  background: $dc1-blue;
  color: #fff;
  font-size: 13px;
  font-weight: 700;
  margin-top: 1px;
}

.stepContent {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.stepTitle {
  font-size: 14px;
  font-weight: 600;
  color: $dc1-text;
}

.stepDesc {
  font-size: 13px;
  color: $dc1-text-secondary;
  line-height: 1.45;
}

.stepArrow {
  width: 16px;
  height: 16px;
  color: $dc1-text-muted;
  flex-shrink: 0;
  margin-top: 6px;
  display: none; /* hidden — keep for semantic */
}

.stepsFooter {
  padding: 14px 24px;
  background: rgba($dc1-success-bg, 0.5);
  border-top: 1px solid rgba($dc1-success, 0.15);
}

.stepsNote {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 13px;
  color: $dc1-success;
  font-weight: 500;
}

.stepsNoteIcon {
  width: 16px;
  height: 16px;
  flex-shrink: 0;
}

/* ── Sample data card ─────────────────────────────────────── */
.sampleCard {
  display: flex;
  align-items: center;
  gap: 20px;
  background: linear-gradient(90deg, #FFFBEB 0%, #FEF3C7 100%);
  border: 1px solid #F5D98C;
  border-radius: $dc1-radius;
  padding: 18px 24px;
}

.sampleLeft {
  flex: 1;
  display: flex;
  align-items: flex-start;
  gap: 12px;
}

.sampleIcon {
  width: 20px;
  height: 20px;
  color: #D97706;
  flex-shrink: 0;
  margin-top: 2px;
}

.sampleTitle {
  font-size: 14px;
  font-weight: 600;
  color: $dc1-text;
  margin: 0 0 2px;
}

.sampleDesc {
  font-size: 13px;
  color: $dc1-text-secondary;
  margin: 0;
  line-height: 1.45;
}

.sampleBtn {
  padding: 10px 22px;
  border-radius: $dc1-radius-sm;
  border: 1px solid $dc1-border;
  background: $dc1-card;
  color: $dc1-text;
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  white-space: nowrap;
  transition: background $transition-fast, box-shadow $transition-fast;

  &:hover {
    background: $neutral-50;
    box-shadow: 0 1px 3px rgba(0,0,0,0.08);
  }

  &:disabled {
    opacity: 0.6;
    cursor: not-allowed;
  }
}

/* ── AI Fix Suggestion (Endpoints) ────────────────────────── */
.aiFixBtn {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 4px 10px;
  border: none;
  border-radius: 4px;
  background: linear-gradient(135deg, #7C3AED 0%, #6D28D9 100%);
  color: $dc1-card;
  font-size: 11px;
  font-weight: 600;
  cursor: pointer;
  white-space: nowrap;
  transition: opacity $transition-fast;

  &:hover { opacity: 0.88; }
  &:disabled { opacity: 0.5; cursor: not-allowed; }
}

.aiFixIcon {
  width: 12px;
  height: 12px;
}

.aiSuggestionRow td {
  padding: 0 !important;
  border-top: none !important;
}

.aiSuggestionPanel {
  background: linear-gradient(135deg, #F5F3FF 0%, #EDE9FE 100%);
  border: 1px solid #DDD6FE;
  border-radius: $dc1-radius;
  padding: 16px 20px;
  margin: 0 12px 12px;
}

.aiSuggestionHeader {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 10px;

  svg {
    width: 16px;
    height: 16px;
    color: #7C3AED;
  }
}

.aiSuggestionTitle {
  font-size: 13px;
  font-weight: 700;
  color: #5B21B6;
}

.aiConfidence {
  font-size: 11px;
  font-weight: 500;
  padding: 2px 8px;
  border-radius: 10px;
  margin-left: auto;
}

.confidenceHigh {
  background: $dc1-success-bg;
  color: $dc1-success;
}

.confidenceMedium {
  background: $dc1-warning-bg;
  color: #92400E;
}

.confidenceLow {
  background: $neutral-100;
  color: $dc1-text-secondary;
}

.aiSuggestionText {
  font-size: 13px;
  color: $dc1-text;
  line-height: 1.6;
  margin: 0 0 10px;
}

.aiCodeBlock {
  background: $neutral-900;
  color: #E2E8F0;
  border-radius: $dc1-radius-sm;
  padding: 12px 16px;
  font-size: 12px;
  font-family: 'JetBrains Mono', 'Fira Code', monospace;
  line-height: 1.6;
  white-space: pre-wrap;
  overflow-x: auto;
  margin: 0;
}

.aiLoading {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 16px 20px;
  font-size: 13px;
  color: #7C3AED;

  svg {
    animation: spin 1s linear infinite;
  }
}

@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* ── AiBanner button spinner ─────────────────────────────── */
.aiBannerBtnSpin {
  width: 14px;
  height: 14px;
  display: inline-block;
  vertical-align: middle;
  margin-right: 4px;
  animation: spin 1s linear infinite;
}

/* ── Not Safe / Safe count in tables ─────────────────────── */
.notSafeCount {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  color: $dc1-danger;
  font-weight: 600;
  font-size: 12px;
}

.notSafeIcon {
  width: 13px;
  height: 13px;
}

.safeCount {
  color: $dc1-success;
  font-weight: 600;
  font-size: 12px;
}

/* ── CBOM AI Insight Panel ───────────────────────────────── */
$_ai-purple: #9333EA;
$_ai-blue: $blue-200;
$_risk-high: $warning-100;

.cbomInsightWrap {
  margin-bottom: 20px;
}

.cbomInsightLoading {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 16px;
  background: linear-gradient(to right, rgba($_ai-purple, 0.04), rgba($_ai-blue, 0.04));
  border: 1px solid rgba($_ai-purple, 0.15);
  border-radius: $dc1-radius;
}

.cbomInsightLoadIcon {
  width: 20px;
  height: 20px;
  color: $_ai-purple;
  animation: spin 1s linear infinite;
  flex-shrink: 0;
}

.cbomInsightPulseBar { flex: 1; }

.cbomInsightPulseBarBig {
  height: 12px;
  width: 66%;
  border-radius: $dc1-radius-sm;
  background: rgba($_ai-purple, 0.08);
  animation: pulse 2s ease-in-out infinite;
}

.cbomInsightPulseBarSmall {
  height: 8px;
  width: 50%;
  border-radius: $dc1-radius-sm;
  background: rgba($_ai-purple, 0.08);
  animation: pulse 2s ease-in-out infinite;
  margin-top: 6px;
}

@keyframes pulse {
  0%, 100% { opacity: 0.4; }
  50% { opacity: 1; }
}

.cbomInsightError {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px;
  background: rgba($dc1-danger, 0.04);
  border: 1px solid rgba($dc1-danger, 0.15);
  border-radius: $dc1-radius;
}

.cbomInsightErrorMsg {
  font-size: 12px;
  color: $dc1-danger;
}

.cbomDismissBtn {
  color: $dc1-text-secondary;
  background: none;
  border: none;
  cursor: pointer;
  padding: 2px;

  &:hover { color: $dc1-text; }
}

.cbomDismissIcon {
  width: 14px;
  height: 14px;
}

.cbomInsightPanel {
  border-radius: $dc1-radius;
  overflow: hidden;
}

.cbomInsightTopBar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 16px 8px;
}

.cbomInsightTopLeft {
  display: flex;
  align-items: center;
  gap: 12px;
}

.cbomInsightTopTitle {
  display: flex;
  align-items: center;
  gap: 8px;
}

.cbomInsightTopTitleIcon {
  width: 16px;
  height: 16px;
}

.cbomInsightTopTitleText {
  font-size: 12px;
  font-weight: 600;
  color: $dc1-text;
}

.cbomInsightRiskBadge {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  font-size: 10px;
  font-weight: 700;
  padding: 2px 8px;
  border-radius: 9999px;
  box-shadow: inset 0 0 0 1px;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.cbomBadgeIcon {
  width: 10px;
  height: 10px;
}

.cbomInsightScoreBar {
  padding: 0 16px 8px;
}

.cbomInsightScoreRow {
  display: flex;
  align-items: center;
  gap: 12px;
}

.cbomInsightTrack {
  flex: 1;
  height: 6px;
  background: rgba($neutral-300, 0.5);
  border-radius: 9999px;
  overflow: hidden;
}

.cbomInsightFill {
  height: 100%;
  border-radius: 9999px;
  transition: width 0.7s ease;
}

.cbomInsightScoreText {
  font-size: 12px;
  font-family: monospace;
  font-weight: 700;
}

.cbomInsightHeadline {
  padding: 0 16px 8px;
  font-size: 14px;
  font-weight: 500;
  margin: 0;
}

.cbomInsightSummary {
  padding: 0 16px 12px;
  font-size: 11px;
  color: $dc1-text-secondary;
  line-height: 1.6;
  margin: 0;
}

.cbomInsightPriorities {
  padding: 0 16px 12px;
}

.cbomInsightPrioritiesLabel {
  font-size: 10px;
  color: $dc1-text-secondary;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-bottom: 6px;
  display: flex;
  align-items: center;
  gap: 4px;
}

.cbomInsightPrioritiesLabelIcon {
  width: 12px;
  height: 12px;
}

.cbomInsightPriorityRow {
  display: flex;
  align-items: flex-start;
  gap: 8px;

  & + & { margin-top: 6px; }
}

.cbomInsightImpactBadge {
  flex-shrink: 0;
  margin-top: 2px;
  display: inline-flex;
  align-items: center;
  font-size: 9px;
  font-weight: 700;
  padding: 2px 6px;
  border-radius: $dc1-radius-sm;
  box-shadow: inset 0 0 0 1px;
}

.cbomInsightPriorityAction {
  font-size: 11px;
  color: $dc1-text-secondary;
  line-height: 1.4;
  flex: 1;
}

.cbomInsightPriorityEffort {
  flex-shrink: 0;
  font-size: 9px;
  color: $dc1-text-secondary;
  font-weight: 500;
  display: flex;
  align-items: center;
  gap: 2px;
}

.cbomInsightClockIcon {
  width: 10px;
  height: 10px;
}

.cbomInsightMigration {
  padding: 8px 16px 12px;
  border-top: 1px solid rgba(#fff, 0.05);
  display: flex;
  align-items: center;
  gap: 8px;
}

.cbomInsightMigrationIcon {
  width: 12px;
  height: 12px;
}

.cbomInsightMigrationText {
  font-size: 10px;
  color: $dc1-text-secondary;
}

.cbomInsightMigrationLabel {
  font-weight: 500;
  color: $dc1-text;
}

// Risk / impact color helpers (CBOM)
.cbomRiskBgCritical    { background: linear-gradient(to right, rgba($dc1-danger, 0.08), rgba($dc1-danger, 0.03)); border: 1px solid rgba($dc1-danger, 0.3); }
.cbomRiskTextCritical  { color: $dc1-danger; }
.cbomRiskBarCritical   { background: $dc1-danger; }
.cbomRiskBadgeCritical { background: rgba($dc1-danger, 0.08); color: $dc1-danger; box-shadow: inset 0 0 0 1px rgba($dc1-danger, 0.3); }

.cbomRiskBgHigh    { background: linear-gradient(to right, rgba($_risk-high, 0.08), rgba($_risk-high, 0.03)); border: 1px solid rgba($_risk-high, 0.3); }
.cbomRiskTextHigh  { color: $_risk-high; }
.cbomRiskBarHigh   { background: $_risk-high; }
.cbomRiskBadgeHigh { background: rgba($_risk-high, 0.08); color: $_risk-high; box-shadow: inset 0 0 0 1px rgba($_risk-high, 0.3); }

.cbomRiskBgModerate    { background: linear-gradient(to right, rgba($dc1-warning, 0.08), rgba($dc1-warning, 0.03)); border: 1px solid rgba($dc1-warning, 0.3); }
.cbomRiskTextModerate  { color: $dc1-warning; }
.cbomRiskBarModerate   { background: $dc1-warning; }
.cbomRiskBadgeModerate { background: rgba($dc1-warning, 0.08); color: $dc1-warning; box-shadow: inset 0 0 0 1px rgba($dc1-warning, 0.3); }

.cbomRiskBgLow    { background: linear-gradient(to right, rgba($dc1-success, 0.08), rgba($dc1-success, 0.03)); border: 1px solid rgba($dc1-success, 0.3); }
.cbomRiskTextLow  { color: $dc1-success; }
.cbomRiskBarLow   { background: $dc1-success; }
.cbomRiskBadgeLow { background: rgba($dc1-success, 0.08); color: $dc1-success; box-shadow: inset 0 0 0 1px rgba($dc1-success, 0.3); }

.cbomRiskBadgeMedium {
  background: rgba($dc1-warning, 0.08);
  color: $dc1-warning;
  box-shadow: inset 0 0 0 1px rgba($dc1-warning, 0.3);
}

/* ═══════════════════════════════════════════════════════════════
   PolicyViolationCell styles  (v3 — compact tag + modal)
   ═══════════════════════════════════════════════════════════════ */

/* ── Inline tag — Compliant ───────────────────────────────── */
.pvTagCompliant {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  font-size: 11px;
  font-weight: 600;
  color: #15803d;
  background: #dcfce7;
  border: 1px solid #86efac;
  border-radius: 20px;
  padding: 3px 10px;
  white-space: nowrap;
}

/* ── Inline tag — Violation count ─────────────────────────── */
.pvTag {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  border: none;
  border-radius: 20px;
  padding: 3px 12px;
  font-size: 11px;
  font-weight: 700;
  font-family: inherit;
  cursor: pointer;
  white-space: nowrap;
  transition: filter 0.15s, box-shadow 0.15s, transform 0.1s;
  &:hover { filter: brightness(0.93); box-shadow: 0 2px 8px rgba(0,0,0,0.12); transform: translateY(-1px); }
  &:active { transform: translateY(0); }
}

.pvTagLabel {
  font-weight: 500;
  font-size: 10px;
  opacity: 0.8;
}

/* Severity variants */
.pvTagCritical {
  background: #fee2e2;
  color: #991b1b;
  box-shadow: inset 0 0 0 1px rgba(153,27,27,0.2);
}
.pvTagHigh {
  background: #fee2e2;
  color: #dc2626;
  box-shadow: inset 0 0 0 1px rgba(220,38,38,0.2);
}
.pvTagMedium {
  background: #fef3c7;
  color: #b45309;
  box-shadow: inset 0 0 0 1px rgba(217,119,6,0.2);
}
.pvTagLow {
  background: #e0f2fe;
  color: #0369a1;
  box-shadow: inset 0 0 0 1px rgba(2,132,199,0.2);
}

/* ═══════════════════════════════════════════════════════════════
   Modal overlay + container
   ═══════════════════════════════════════════════════════════════ */
.pvOverlay {
  position: fixed;
  inset: 0;
  z-index: 9999;
  background: rgba(15, 23, 42, 0.55);
  backdrop-filter: blur(4px);
  display: flex;
  align-items: center;
  justify-content: center;
  animation: pvFadeIn 0.15s ease-out;
}

@keyframes pvFadeIn {
  from { opacity: 0; }
  to   { opacity: 1; }
}

.pvModal {
  background: #fff;
  border-radius: 14px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.18), 0 0 0 1px rgba(0,0,0,0.04);
  width: min(560px, 92vw);
  max-height: 80vh;
  display: flex;
  flex-direction: column;
  animation: pvSlideUp 0.2s ease-out;
  overflow: hidden;
}

@keyframes pvSlideUp {
  from { opacity: 0; transform: translateY(16px) scale(0.98); }
  to   { opacity: 1; transform: translateY(0) scale(1); }
}

/* ── Modal header ─────────────────────────────────────────── */
.pvModalHeader {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  padding: 20px 24px 16px;
  border-bottom: 1px solid #e2e8f0;
}

.pvModalHeaderLeft {
  display: flex;
  align-items: flex-start;
  gap: 12px;
}

.pvModalTitle {
  font-size: 16px;
  font-weight: 700;
  color: #0f172a;
  margin: 0;
  line-height: 1.2;
}

.pvModalSubtitle {
  font-size: 12px;
  color: #64748b;
  margin: 4px 0 0;
}

.pvModalHeaderRight {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-shrink: 0;
}

.pvModalClose {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  border-radius: 8px;
  border: 1px solid #e2e8f0;
  background: #f8fafc;
  color: #64748b;
  cursor: pointer;
  transition: background 0.15s, color 0.15s;
  &:hover { background: #f1f5f9; color: #334155; }
}

/* ── Modal AI button ──────────────────────────────────────── */
.pvModalAiBtn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
  color: #fff;
  border: none;
  border-radius: 8px;
  padding: 7px 14px;
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
  font-family: inherit;
  letter-spacing: 0.2px;
  transition: opacity 0.15s, transform 0.15s, box-shadow 0.15s;
  box-shadow: 0 2px 8px rgba(124,58,237,0.25);
  &:hover { opacity: 0.92; transform: translateY(-1px); box-shadow: 0 4px 14px rgba(124,58,237,0.35); }
  &:disabled { opacity: 0.5; cursor: not-allowed; transform: none; box-shadow: none; }
}

@keyframes pvSpin { to { transform: rotate(360deg); } }
.pvAiSpin { animation: pvSpin 1s linear infinite; }

/* severity icon colors */
.pvIconSevCritical { color: #991b1b; }
.pvIconSevHigh     { color: #dc2626; }
.pvIconSevMedium   { color: #b45309; }
.pvIconSevLow      { color: #0369a1; }

/* ── AI result / error banners inside modal ───────────────── */
.pvModalAiResult {
  display: flex;
  align-items: flex-start;
  gap: 8px;
  font-size: 12px;
  color: #5b21b6;
  background: linear-gradient(135deg, #f5f3ff 0%, #ede9fe 100%);
  border-bottom: 1px solid #c4b5fd;
  padding: 12px 24px;
  line-height: 1.55;
}

.pvModalAiIcon {
  flex-shrink: 0;
  margin-top: 2px;
  color: #8b5cf6;
}

.pvModalAiError {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 12px;
  color: #d97706;
  background: #fffbeb;
  border-bottom: 1px solid #fde68a;
  padding: 10px 24px;
}

/* ── Modal body (scrollable) ──────────────────────────────── */
.pvModalBody {
  padding: 16px 24px 24px;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

/* ── Policy violation card ────────────────────────────────── */
.pvCard {
  border: 1px solid #e2e8f0;
  border-radius: 10px;
  padding: 14px 16px;
  background: #fff;
  transition: box-shadow 0.15s;

  &:hover { box-shadow: 0 2px 8px rgba(0,0,0,0.06); }
}

.pvCardCritical { border-left: 3px solid #991b1b; }
.pvCardHigh     { border-left: 3px solid #dc2626; }
.pvCardMedium   { border-left: 3px solid #d97706; }
.pvCardLow      { border-left: 3px solid #0284c7; }

.pvCardHeader {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 8px;
}

.pvCardName {
  font-size: 13px;
  font-weight: 700;
  color: #0f172a;
  flex: 1;
}

.pvSevBadge {
  font-size: 10px;
  padding: 2px 8px;
  border-radius: 20px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.4px;
}

.pvSevBadgeCritical { background: #fef2f2; color: #991b1b; }
.pvSevBadgeHigh     { background: #fef2f2; color: #dc2626; }
.pvSevBadgeMedium   { background: #fffbeb; color: #b45309; }
.pvSevBadgeLow      { background: #eff6ff; color: #1d4ed8; }

.pvCardAssetCount {
  font-size: 11px;
  color: #94a3b8;
  white-space: nowrap;
}

.pvCardEmpty {
  display: flex;
  align-items: center;
  gap: 4px;
  color: #94a3b8;
  font-size: 11px;
  font-style: italic;
  padding: 4px 0;
}

.pvCardRules {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.pvCardAssetGroup {
  display: flex;
  flex-direction: column;
  gap: 3px;
  padding: 6px 10px;
  background: #f8fafc;
  border-radius: 6px;
  border: 1px solid #f1f5f9;
}

.pvCardAssetName {
  font-weight: 600;
  font-size: 11px;
  color: #334155;
  margin-bottom: 2px;
}

.pvCardRule {
  display: flex;
  align-items: center;
  gap: 5px;
  font-size: 11px;
  color: #64748b;
  padding: 2px 0;
}

.pvRuleField {
  font-weight: 600;
  color: #334155;
}

.pvRuleCond {
  font-style: italic;
  color: #94a3b8;
  font-size: 10px;
}

.pvRuleExpected {
  font-family: 'JetBrains Mono', monospace;
  font-size: 10px;
  font-weight: 500;
  color: #15803d;
  background: #dcfce7;
  padding: 1px 6px;
  border-radius: 4px;
  border: 1px solid #bbf7d0;
}

.pvRuleArrow {
  color: #94a3b8;
}

.pvRuleActual {
  font-family: 'JetBrains Mono', monospace;
  font-size: 10px;
  font-weight: 500;
  color: #dc2626;
  background: #fee2e2;
  padding: 1px 6px;
  border-radius: 4px;
  border: 1px solid #fecaca;
}

.pvCardMore {
  font-size: 11px;
  color: #94a3b8;
  font-weight: 500;
  font-style: italic;
  text-align: center;
  padding: 4px 0;
}

/* ── Passed policies section ──────────────────────────────── */
.pvPassedSection {
  border: 1px solid #d1fae5;
  border-radius: 10px;
  padding: 12px 16px;
  background: #f0fdf4;
}

.pvPassedHeader {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 12px;
  font-weight: 600;
  color: #15803d;
  margin-bottom: 8px;
}

.pvPassedList {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
}

.pvPassedTag {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  font-size: 11px;
  font-weight: 500;
  color: #166534;
  background: #dcfce7;
  border: 1px solid #86efac;
  border-radius: 6px;
  padding: 2px 8px;
}
